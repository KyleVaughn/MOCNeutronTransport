
# TODO Implement Dunavant's algorithm in julia and compute these values to higher
# precision
# Dunavant, D. (1985). High degree efficient symmetrical Gaussian quadrature rules 
# for the triangle. International journal for numerical methods in engineering, 21(6), 
# 1129-1148.
"""
    triangular_gauss_legendre_quadrature(::Type{T}, ::Val{N})

Return the `N` Gauss weights and points on the parametric unit triangle, with ∑wᵢ= 1/2,
rᵢ∈ [0, 1], sᵢ∈ [0, 1], rᵢ + sᵢ ≤ 1.
Valid `N` for this function are `N` ∈ [3, 4, 6, 12, 27, 48, 79]
"""
function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{1}) where {T}
    # P1. 0 negative weights, 0 points outside of the triangle
    w = @SVector T[0.500000000000000]

    r = @SVector T[0.333333333333333]

    s = @SVector T[0.333333333333333]
    return w, r, s
end

function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{3}) where {T}
    # P2. 0 negative weights, 0 points outside of the triangle
    w = @SVector T[0.166666666666667,
                  0.166666666666667,
                  0.166666666666667]

    r = @SVector T[0.166666666666667,
                  0.166666666666667,
                  0.666666666666667]

    s = @SVector T[0.166666666666667, 
                  0.666666666666667, 
                  0.166666666666667] 
    return w, r, s
end

function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{4}) where {T}
    # P3. 1 negative weights, 0 points outside of the triangle
    w = @SVector T[-0.281250000000000,
                    0.260416666666667,   
                    0.260416666666667,
                    0.260416666666667]

    r = @SVector T[0.333333333333333, 
                   0.200000000000000, 
                   0.200000000000000, 
                   0.600000000000000] 

    s = @SVector T[0.333333333333333,
                   0.200000000000000,
                   0.600000000000000,
                   0.200000000000000]
    return w, r, s
end

function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{6}) where {T}
    # P4. 0 negative weights, 0 points outside of the triangle
    w = @SVector T[0.111690794839005,
                  0.111690794839005,
                  0.111690794839005,
                  0.054975871827661,
                  0.054975871827661,
                  0.054975871827661]
    r = @SVector T[0.445948490915965,
                  0.445948490915965,
                  0.108103018168070,
                  0.091576213509771,
                  0.091576213509771,
                  0.816847572980459]

    s = @SVector T[0.445948490915965,
                  0.108103018168070,
                  0.445948490915965,
                  0.091576213509771,
                  0.816847572980459,
                  0.091576213509771]
    return w, r, s
end

function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{12}) where {T}
    # P6. 0 negative weights, 0 points outside of the triangle
    w = @SVector T[0.058393137863189,
          0.058393137863189,
          0.058393137863189,
          0.025422453185104,
          0.025422453185104,
          0.025422453185104,
          0.041425537809187,
          0.041425537809187,
          0.041425537809187,
          0.041425537809187,
          0.041425537809187,
          0.041425537809187]

    r = @SVector T[0.249286745170910,
          0.249286745170910,
          0.501426509658179,
          0.063089014491502,
          0.063089014491502,
          0.873821971016996,
          0.310352451033785,
          0.636502499121399,
          0.053145049844816,
          0.310352451033785,
          0.636502499121399,
          0.053145049844816]

    s = @SVector T[0.249286745170910,
          0.501426509658179,
          0.249286745170910,
          0.063089014491502,
          0.873821971016996,
          0.063089014491502,
          0.636502499121399,
          0.053145049844816,
          0.310352451033785,
          0.053145049844816,
          0.310352451033785,
          0.636502499121399]
    return w, r, s
end

function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{27}) where {T}
    # P11. 0 negative weights, 3 points outside of the triangle
    w = @SVector T[0.00046350316448,
          0.00046350316448,
          0.00046350316448,
          0.03857476745740,
          0.03857476745740,
          0.03857476745740,
          0.02966148869040,
          0.02966148869040,
          0.02966148869040,
          0.01809227025170,
          0.01809227025170,
          0.01809227025170,
          0.00682986550135,
          0.00682986550135,
          0.00682986550135,
          0.02616855598110,
          0.02616855598110,
          0.02616855598110,
          0.02616855598110,
          0.02616855598110,
          0.02616855598110,
          0.01035382981955,
          0.01035382981955,
          0.01035382981955,
          0.01035382981955,
          0.01035382981955,
          0.01035382981955]

    r = @SVector T[+0.5346110482710,
          -0.0692220965415,
          +0.5346110482710,
          +0.3989693029660,
          +0.2020613940680,
          +0.3989693029660,
          +0.2033099004310,
          +0.5933801991370,
          +0.2033099004310,
          +0.1193509122830,
          +0.7612981754350,
          +0.1193509122830,
          +0.0323649481113,
          +0.9352701037770,
          +0.0323649481113,
          +0.5932012134280,
          +0.0501781383105,
          +0.3566206482610,
          +0.0501781383105,
          +0.3566206482610,
          +0.5932012134280,
          +0.8074890031600,
          +0.0210220165362,
          +0.1714889803040,
          +0.0210220165362,
          +0.1714889803040,
          +0.8074890031600]
    
    s = @SVector T[+0.5346110482710,
          +0.5346110482710,
          -0.0692220965415,
          +0.3989693029660,
          +0.3989693029660,
          +0.2020613940680,
          +0.2033099004310,
          +0.2033099004310,
          +0.5933801991370,
          +0.1193509122830,
          +0.1193509122830,
          +0.7612981754350,
          +0.0323649481113,
          +0.0323649481113,
          +0.9352701037770,
          +0.3566206482610,
          +0.5932012134280,
          +0.0501781383105,
          +0.3566206482610,
          +0.5932012134280,
          +0.0501781383105,
          +0.1714889803040,
          +0.8074890031600,
          +0.0210220165362,
          +0.1714889803040,
          +0.8074890031600,
          +0.0210220165362]
    return w, r, s
end

function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{48}) where {T}
    # P15. 0 negative weights, 9 points outside of the triangle
    w = @SVector T[0.000958437821425,
          0.000958437821425,
          0.000958437821425,
          0.022124513635550,
          0.022124513635550,
          0.022124513635550,
          0.025593274359450,
          0.025593274359450,
          0.025593274359450,
          0.011843867935350,
          0.011843867935350,
          0.011843867935350,
          0.006644887845000,
          0.006644887845000,
          0.006644887845000,
          0.002374458304095,
          0.002374458304095,
          0.002374458304095,
          0.019275036299800,
          0.019275036299800,
          0.019275036299800,
          0.019275036299800,
          0.019275036299800,
          0.019275036299800,
          0.013607907160300,
          0.013607907160300,
          0.013607907160300,
          0.013607907160300,
          0.013607907160300,
          0.013607907160300,
          0.001091038683400,
          0.001091038683400,
          0.001091038683400,
          0.001091038683400,
          0.001091038683400,
          0.001091038683400,
          0.010752659923850,
          0.010752659923850,
          0.010752659923850,
          0.010752659923850,
          0.010752659923850,
          0.010752659923850,
          0.003836971315525,
          0.003836971315525,
          0.003836971315525,
          0.003836971315525,
          0.003836971315525,
          0.003836971315525]

    r = @SVector T[+0.5069729168580,
          -0.0139458337165,
          +0.5069729168580,
          +0.4314063542830,
          +0.1371872914340,
          +0.4314063542830,
          +0.2776936448470,
          +0.4446127103060,
          +0.2776936448470,
          +0.1264648910410,
          +0.7470702179170,
          +0.1264648910410,
          +0.0708083859747,
          +0.8583832280510,
          +0.0708083859747,
          +0.0189651702411,
          +0.9620696595180,
          +0.0189651702411,
          +0.6049544668930,
          +0.1337341619670,
          +0.2613113711400,
          +0.1337341619670,
          +0.2613113711400,
          +0.6049544668930,
          +0.5755865555130,
          +0.0363666773969,
          +0.3880467670900,
          +0.0363666773969,
          +0.3880467670900,
          +0.5755865555130,
          +0.7244626630770,
          -0.0101748831266,
          +0.2857122200500,
          -0.0101748831266,
          +0.2857122200500,
          +0.7244626630770,
          +0.7475564660520,
          +0.0368438698759,
          +0.2155996640720,
          +0.0368438698759,
          +0.2155996640720,
          +0.7475564660520,
          +0.8839645740920,
          +0.0124598093312,
          +0.1035756165760,
          +0.0124598093312,
          +0.1035756165760,
          +0.8839645740920]

    s = @SVector T[+0.5069729168580,
          +0.5069729168580,
          -0.0139458337165,
          +0.4314063542830,
          +0.4314063542830,
          +0.1371872914340,
          +0.2776936448470,
          +0.2776936448470,
          +0.4446127103060,
          +0.1264648910410,
          +0.1264648910410,
          +0.7470702179170,
          +0.0708083859747,
          +0.0708083859747,
          +0.8583832280510,
          +0.0189651702411,
          +0.0189651702411,
          +0.9620696595180,
          +0.2613113711400,
          +0.6049544668930,
          +0.1337341619670,
          +0.2613113711400,
          +0.6049544668930,
          +0.1337341619670,
          +0.3880467670900,
          +0.5755865555130,
          +0.0363666773969,
          +0.3880467670900,
          +0.5755865555130,
          +0.0363666773969,
          +0.2857122200500,
          +0.7244626630770,
          -0.0101748831266,
          +0.2857122200500,
          +0.7244626630770,
          -0.0101748831266,
          +0.2155996640720,
          +0.7475564660520,
          +0.0368438698759,
          +0.2155996640720,
          +0.7475564660520,
          +0.0368438698759,
          +0.1035756165760,
          +0.8839645740920,
          +0.0124598093312,
          +0.1035756165760,
          +0.8839645740920,
          +0.0124598093312]
    return w, r, s
end

function triangular_gauss_legendre_quadrature(::Type{T}, ::Val{79}) where {T}
    # P20. 3 negative weights, 9 points outside of the triangle
    w = @SVector T[+0.016528527770800,
          +0.000433509592831,
          +0.000433509592831,
          +0.000433509592831,
          +0.005830026358200,
          +0.005830026358200,
          +0.005830026358200,
          +0.011438468178200,
          +0.011438468178200,
          +0.011438468178200,
          +0.015224491336950,
          +0.015224491336950,
          +0.015224491336950,
          +0.015312445862700,
          +0.015312445862700,
          +0.015312445862700,
          +0.012184028838400,
          +0.012184028838400,
          +0.012184028838400,
          +0.007998716016000,
          +0.007998716016000,
          +0.007998716016000,
          +0.003849150907800,
          +0.003849150907800,
          +0.003849150907800,
          -0.000316030248744,
          -0.000316030248744,
          -0.000316030248744,
          +0.000875567150595,
          +0.000875567150595,
          +0.000875567150595,
          +0.008232919594800,
          +0.008232919594800,
          +0.008232919594800,
          +0.008232919594800,
          +0.008232919594800,
          +0.008232919594800,
          +0.002419516770245,
          +0.002419516770245,
          +0.002419516770245,
          +0.002419516770245,
          +0.002419516770245,
          +0.002419516770245,
          +0.012902453267350,
          +0.012902453267350,
          +0.012902453267350,
          +0.012902453267350,
          +0.012902453267350,
          +0.012902453267350,
          +0.004235545527220,
          +0.004235545527220,
          +0.004235545527220,
          +0.004235545527220,
          +0.004235545527220,
          +0.004235545527220,
          +0.009177457053150,
          +0.009177457053150,
          +0.009177457053150,
          +0.009177457053150,
          +0.009177457053150,
          +0.009177457053150,
          +0.000352202338954,
          +0.000352202338954,
          +0.000352202338954,
          +0.000352202338954,
          +0.000352202338954,
          +0.000352202338954,
          +0.005056342463750,
          +0.005056342463750,
          +0.005056342463750,
          +0.005056342463750,
          +0.005056342463750,
          +0.005056342463750,
          +0.001786954692975,
          +0.001786954692975,
          +0.001786954692975,
          +0.001786954692975,
          +0.001786954692975,
          +0.001786954692975]

    r = @SVector T[+0.3333333333333,
          +0.5009504643520,
          -0.0019009287044,
          +0.5009504643520,
          +0.4882129579350,
          +0.0235740841305,
          +0.4882129579350,
          +0.4551366869500,
          +0.0897266360994,
          +0.4551366869500,
          +0.4019962593180,
          +0.1960074813630,
          +0.4019962593180,
          +0.2558929097590,
          +0.4882141804810,
          +0.2558929097590,
          +0.1764882559950,
          +0.6470234880100,
          +0.1764882559950,
          +0.1041708553370,
          +0.7916582893260,
          +0.1041708553370,
          +0.0530689638409,
          +0.8938620723180,
          +0.0530689638409,
          +0.0416187151960,
          +0.9167625696080,
          +0.0416187151960,
          +0.0115819214068,
          +0.9768361571860,
          +0.0115819214068,
          +0.6064026461060,
          +0.0487415836648,
          +0.3448557702290,
          +0.0487415836648,
          +0.3448557702290,
          +0.6064026461060,
          +0.6158426144570,
          +0.0063141159486,
          +0.3778432695950,
          +0.0063141159486,
          +0.3778432695950,
          +0.6158426144570,
          +0.5590480003900,
          +0.1343165205470,
          +0.3066354790620,
          +0.1343165205470,
          +0.3066354790620,
          +0.5590480003900,
          +0.7366067432630,
          +0.0139738939624,
          +0.2494193627750,
          +0.0139738939624,
          +0.2494193627750,
          +0.7366067432630,
          +0.7116751422870,
          +0.0755491329098,
          +0.2127757248030,
          +0.0755491329098,
          +0.2127757248030,
          +0.7116751422870,
          +0.8614027171550,
          -0.0083681532082,
          +0.1469654360530,
          -0.0083681532082,
          +0.1469654360530,
          +0.8614027171550,
          +0.8355869579120,
          +0.0266860632587,
          +0.1377269788290,
          +0.0266860632587,
          +0.1377269788290,
          +0.8355869579120,
          +0.9297561715570,
          +0.0105477192941,
          +0.0596961091490,
          +0.0105477192941,
          +0.0596961091490,
          +0.9297561715570]

    s = @SVector T[ +0.3333333333333,
           +0.5009504643520,
           +0.5009504643520,
           -0.0019009287044,
           +0.4882129579350,
           +0.4882129579350,
           +0.0235740841305,
           +0.4551366869500,
           +0.4551366869500,
           +0.0897266360994,
           +0.4019962593180,
           +0.4019962593180,
           +0.1960074813630,
           +0.2558929097590,
           +0.2558929097590,
           +0.4882141804810,
           +0.1764882559950,
           +0.1764882559950,
           +0.6470234880100,
           +0.1041708553370,
           +0.1041708553370,
           +0.7916582893260,
           +0.0530689638409,
           +0.0530689638409,
           +0.8938620723180,
           +0.0416187151960,
           +0.0416187151960,
           +0.9167625696080,
           +0.0115819214068,
           +0.0115819214068,
           +0.9768361571860,
           +0.3448557702290,
           +0.6064026461060,
           +0.0487415836648,
           +0.3448557702290,
           +0.6064026461060,
           +0.0487415836648,
           +0.3778432695950,
           +0.6158426144570,
           +0.0063141159486,
           +0.3778432695950,
           +0.6158426144570,
           +0.0063141159486,
           +0.3066354790620,
           +0.5590480003900,
           +0.1343165205470,
           +0.3066354790620,
           +0.5590480003900,
           +0.1343165205470,
           +0.2494193627750,
           +0.7366067432630,
           +0.0139738939624,
           +0.2494193627750,
           +0.7366067432630,
           +0.0139738939624,
           +0.2127757248030,
           +0.7116751422870,
           +0.0755491329098,
           +0.2127757248030,
           +0.7116751422870,
           +0.0755491329098,
           +0.1469654360530,
           +0.8614027171550,
           -0.0083681532082,
           +0.1469654360530,
           +0.8614027171550,
           -0.0083681532082,
           +0.1377269788290,
           +0.8355869579120,
           +0.0266860632587,
           +0.1377269788290,
           +0.8355869579120,
           +0.0266860632587,
           +0.0596961091490,
           +0.9297561715570,
           +0.0105477192941,
           +0.0596961091490,
           +0.9297561715570,
           +0.0105477192941]
    return w, r, s
end
